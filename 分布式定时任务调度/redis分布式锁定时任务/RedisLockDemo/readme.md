# redis分布式锁实现分布式定时任务执行
## 涉及知识点
1. redis分布式锁具体实现
2. springboot注解静态实现定时任务
3. 分布式锁加成分布式定时任务执行调度
## 解决问题：
1. 多台机器的时间一致性问题
   - 分布式场景下，每台机器的时区有可能是不一致的，或者相差几秒时间，导致服务逻辑错误
2. 锁未释放问题（某台服务器宕机场景）
   - 即要避免死锁问题
3. 命名空间问题
    - 每个定时任务应该有不同的锁命名，防止出现同名锁。

## 加锁后仍需解决的问题
1. 多个定时任务的多个并发执行sendmail，key如何保证唯一？
   - ip+端口作为key
   
2. 两台服务器时间差超过预设的超时时长怎么办？
   - 根据不同业务，设置不同的超时时间
   
## 总结
redis的分布式锁并不是一个很好的解决方案，依靠第三方框架仍然是最为推荐的方案